# ::format::
# [name]
# query = filter

[AD Users]
query = adapters=="active_directory_adapter"

[AD Disabled Users]
query = adapters_data.active_directory_adapter.account_disabled == true

[AD Enabled Users]
query = adapters_data.active_directory_adapter.account_disabled == false

[AD Enabled Locked Users]
query = adapters_data.active_directory_adapter.ad_uac_account_disable == false and adapters_data.active_directory_adapter.is_locked == true

[AD Enabled Users Whose Password Does Not Expire]
query = adapters_data.active_directory_adapter.ad_uac_account_disable == false and adapters_data.active_directory_adapter.password_never_expires == true

[AD Enabled Users Whose Password Must Change]
query = adapters_data.active_directory_adapter.ad_uac_account_disable == false and adapters_data.active_directory_adapter.ad_pwd_must_change == true

[AD Enabled Users Whose Password Is Not Required]
query = adapters_data.active_directory_adapter.ad_uac_account_disable == false and adapters_data.active_directory_adapter.ad_uac_password_not_required == true

[AD Enabled Users Who Has Dial In Enabled]
query = adapters_data.active_directory_adapter.ad_uac_account_disable == false and adapters_data.active_directory_adapter.ad_dialin_policy == "Dial In Enabled"

[AD Enabled Users With Dial In Policy Of 'Control Access With NPS']
query = adapters_data.active_directory_adapter.ad_uac_account_disable == false and adapters_data.active_directory_adapter.ad_dialin_policy == "Control Access Through NPS Network Policy"

[AD Enabled Users With No Pre Auth Required]
query = adapters_data.active_directory_adapter.ad_uac_account_disable == false and adapters_data.active_directory_adapter.ad_uac_dont_require_preauth == true

[AD Enabled Users in 'Account Operators' Group]
query = adapters_data.active_directory_adapter.ad_uac_account_disable == false and adapters_data.active_directory_adapter.ad_member_of == regex("Account Operators", "i")

[AD Enabled Users in 'Backup Operators' Group]
query = adapters_data.active_directory_adapter.ad_uac_account_disable == false and adapters_data.active_directory_adapter.ad_member_of == regex("Backup Operators", "i")

[AD Enabled Users in 'Print Operators' Group]
query = adapters_data.active_directory_adapter.ad_uac_account_disable == false and adapters_data.active_directory_adapter.ad_member_of == regex("Print Operators", "i")

[AD Enabled Users in 'Cert Publishers' Group]
query = adapters_data.active_directory_adapter.ad_uac_account_disable == false and adapters_data.active_directory_adapter.ad_member_of == regex("Cert Publishers", "i")

[AD Enabled Users in 'Server Operators' Group]
query = adapters_data.active_directory_adapter.ad_uac_account_disable == false and adapters_data.active_directory_adapter.ad_member_of == regex("Server Operators", "i")

[AD Enabled Users in 'Schema Admins' Group]
query = adapters_data.active_directory_adapter.ad_uac_account_disable == false and adapters_data.active_directory_adapter.ad_member_of == regex("Schema Admins", "i")

[AD Enabled Users in 'Administrators' Group]
query = adapters_data.active_directory_adapter.ad_uac_account_disable == false and adapters_data.active_directory_adapter.ad_member_of == regex("Administrators", "i")

[AD Enabled Users in 'Domain Admins' Group]
query = adapters_data.active_directory_adapter.ad_uac_account_disable == false and adapters_data.active_directory_adapter.ad_member_of == regex("Domain Admins", "i")

[AD Enabled Users in 'Enterprise Admins' Group]
query = adapters_data.active_directory_adapter.ad_uac_account_disable == false and adapters_data.active_directory_adapter.ad_member_of == regex("Enterprise Admins", "i")

[AD Enabled Users With Bad Configurations]
query = adapters_data.active_directory_adapter.ad_uac_account_disable == false and (adapters_data.active_directory_adapter.ad_uac_dont_expire_password == true or adapters_data.active_directory_adapter.ad_uac_password_not_required == true or adapters_data.active_directory_adapter.ad_uac_dont_require_preauth == true)

[AD Enabled Critical Users]
query = adapters_data.active_directory_adapter.ad_uac_account_disable == false and (adapters_data.active_directory_adapter.ad_member_of == regex("Account Operators", "i") or adapters_data.active_directory_adapter.ad_member_of == regex("Backup Operators", "i") or adapters_data.active_directory_adapter.ad_member_of == regex("Print Operators", "i") or adapters_data.active_directory_adapter.ad_member_of == regex("Cert Publishers", "i") or adapters_data.active_directory_adapter.ad_member_of == regex("Server Operators", "i") or adapters_data.active_directory_adapter.ad_member_of == regex("Schema Admins", "i") or adapters_data.active_directory_adapter.ad_member_of == regex("Administrators", "i") or adapters_data.active_directory_adapter.ad_member_of == regex("Domain Admins", "i") or adapters_data.active_directory_adapter.ad_member_of == regex("Enterprise Admins", "i"))
