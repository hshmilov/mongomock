# ::format::
# [name]
# view = mongodb json dumps of the view

[Users found in HIBP with compromised passwords]
description = Users with passwords used in known breaches by Have I Been Pwned (HIBP) and have not been changed in the last 500 days.
tags = ["Compromised Credentials", "Old Passwords", "User Management"]
view = {
        "fields" : [
            "adapters",
            "specific_data.data.image",
            "specific_data.data.username",
            "specific_data.data.domain",
            "specific_data.data.is_admin",
            "specific_data.data.last_seen",
            "labels"
        ],
        "coloumnSizes" : [],
        "query" : {
            "filter" : "(adapters_data.haveibeenpwned_adapter.breaches_data.breach_date >= date(\"NOW - 500d\")) and not (specific_data.data.last_password_change >= date(\"NOW - 500d\")) and ((specific_data.data.last_password_change == ({\"$exists\":true,\"$ne\":null})))",
            "expressions" : [
                {
                    "logicOp" : "",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "adapters_data.haveibeenpwned_adapter.breaches_data.breach_date",
                    "compOp" : "days",
                    "value" : 500,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 0,
                    "filteredAdapters" : null,
                    "fieldType" : "haveibeenpwned_adapter"
                },
                {
                    "logicOp" : "and",
                    "not" : true,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "specific_data.data.last_password_change",
                    "compOp" : "days",
                    "value" : 500,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 1,
                    "fieldType" : "axonius"
                },
                {
                    "logicOp" : "and",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "specific_data.data.last_password_change",
                    "compOp" : "exists",
                    "value" : null,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 2,
                    "fieldType" : "axonius"
                }
            ]
        },
        "sort" : {
            "desc" : true,
            "field" : ""
        }
    }

[Users disabled in Okta but not in AD]
description = Users with accounts only partially disabled, meaning, not disabled in all the organization's IAM providers.
tags = ["Compromised Credentials", "AD", "User Management"]
view = {
        "fields" : [
            "adapters",
            "specific_data.data.image",
            "specific_data.data.username",
            "specific_data.data.domain",
            "specific_data.data.is_admin",
            "specific_data.data.last_seen",
            "labels"
        ],
        "coloumnSizes" : [],
        "query" : {
            "filter" : "(adapters_data.okta_adapter.account_disabled == true) and (adapters_data.active_directory_adapter.account_disabled == true)",
            "expressions" : [
                {
                    "logicOp" : "",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "adapters_data.okta_adapter.account_disabled",
                    "compOp" : "true",
                    "value" : null,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 0,
                    "filteredAdapters" : null,
                    "fieldType" : "okta_adapter"
                },
                {
                    "logicOp" : "and",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "adapters_data.active_directory_adapter.account_disabled",
                    "compOp" : "true",
                    "value" : null,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 1,
                    "filteredAdapters" : null,
                    "fieldType" : "active_directory_adapter"
                }
            ]
        },
        "sort" : {
            "field" : "",
            "desc" : true
        }
    }

[Admin users with passwords that never expire]
description = Active admin users with passwords that never expire.
tags = ["Compromised Credentials", "Old Passwords", "Privileged Users", "User Management"]
view = {
        "fields" : [
            "adapters",
            "specific_data.data.image",
            "specific_data.data.username",
            "specific_data.data.domain",
            "specific_data.data.is_admin",
            "specific_data.data.last_seen",
            "labels"
        ],
        "coloumnSizes" : [],
        "query" : {
            "filter" : "(specific_data.data.is_admin == true) and (specific_data.data.account_disabled == false) and (specific_data.data.password_never_expires == true)",
            "expressions" : [
                {
                    "logicOp" : "",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "specific_data.data.is_admin",
                    "compOp" : "true",
                    "value" : null,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 0,
                    "fieldType" : "axonius"
                },
                {
                    "logicOp" : "and",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "specific_data.data.account_disabled",
                    "compOp" : "false",
                    "value" : null,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 1,
                    "fieldType" : "axonius"
                },
                {
                    "logicOp" : "and",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "specific_data.data.password_never_expires",
                    "compOp" : "true",
                    "value" : null,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 2,
                    "fieldType" : "axonius"
                }
            ]
        },
        "sort" : {
            "desc" : true,
            "field" : ""
        }
    }

[Active admin users with passwords not changed in the last 30 days]
description = Active admin users, seen in the domain in the last 7 days, and have not changed their password in last 30 days.
tags = ["Old Passwords", "Privileged Users", "User Management"]
view = {
        "fields" : [
            "adapters",
            "specific_data.data.image",
            "specific_data.data.username",
            "specific_data.data.domain",
            "specific_data.data.is_admin",
            "specific_data.data.last_seen",
            "specific_data.data.last_password_change",
            "labels"
        ],
        "coloumnSizes" : [],
        "query" : {
            "filter" : "(specific_data.data.is_admin == true) and ((specific_data.data.last_password_change == ({\"$exists\":true,\"$ne\":null}))) and not (specific_data.data.last_password_change >= date(\"NOW - 30d\")) and (specific_data.data.account_disabled == false) and (specific_data.data.last_seen >= date(\"NOW - 7d\"))",
            "expressions" : [
                {
                    "logicOp" : "",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "specific_data.data.is_admin",
                    "compOp" : "true",
                    "value" : null,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 0,
                    "fieldType" : "axonius"
                },
                {
                    "logicOp" : "and",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "specific_data.data.last_password_change",
                    "compOp" : "exists",
                    "value" : null,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 1,
                    "fieldType" : "axonius"
                },
                {
                    "logicOp" : "and",
                    "not" : true,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "specific_data.data.last_password_change",
                    "compOp" : "days",
                    "value" : 30,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 2,
                    "fieldType" : "axonius"
                },
                {
                    "logicOp" : "and",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "specific_data.data.account_disabled",
                    "compOp" : "false",
                    "value" : null,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 3,
                    "fieldType" : "axonius"
                },
                {
                    "logicOp" : "and",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "specific_data.data.last_seen",
                    "compOp" : "days",
                    "value" : 7,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 4,
                    "fieldType" : "axonius"
                }
            ]
        },
        "sort" : {
            "desc" : true,
            "field" : ""
        }
    }

[Users with passwords not changed in the last 30 days]
description = Active "real" users (first name or an image exist), seen in the domain in the last 7 days, and have not changed their password in the last 30 days.
tags = ["Old Passwords", "User Management"]
view = {
        "fields" : [
            "adapters",
            "specific_data.data.image",
            "specific_data.data.username",
            "specific_data.data.domain",
            "specific_data.data.is_admin",
            "specific_data.data.last_seen",
            "specific_data.data.last_password_change",
            "labels"
        ],
        "coloumnSizes" : [],
        "query" : {
            "filter" : "(specific_data.data.account_disabled == false) and not (specific_data.data.last_password_change >= date(\"NOW - 30d\")) and (specific_data.data.last_seen >= date(\"NOW - 7d\")) and (((specific_data.data.first_name == ({\"$exists\":true,\"$ne\":\"\"}))) or ((specific_data.data.image == ({\"$exists\":true,\"$ne\":\"\"}))))",
            "expressions" : [
                {
                    "logicOp" : "",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "specific_data.data.account_disabled",
                    "compOp" : "false",
                    "value" : null,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 0,
                    "fieldType" : "axonius"
                },
                {
                    "logicOp" : "and",
                    "not" : true,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "specific_data.data.last_password_change",
                    "compOp" : "days",
                    "value" : 30,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 1,
                    "fieldType" : "axonius"
                },
                {
                    "logicOp" : "and",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "specific_data.data.last_seen",
                    "compOp" : "days",
                    "value" : 7,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 2,
                    "fieldType" : "axonius"
                },
                {
                    "logicOp" : "and",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : true,
                    "field" : "specific_data.data.first_name",
                    "compOp" : "exists",
                    "value" : null,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 3,
                    "fieldType" : "axonius"
                },
                {
                    "logicOp" : "or",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "specific_data.data.image",
                    "compOp" : "exists",
                    "value" : null,
                    "rightBracket" : true,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 4,
                    "fieldType" : "axonius"
                }
            ]
        },
        "sort" : {
            "desc" : true,
            "field" : ""
        }
    }

[AD enabled users with bad configurations]
description = AD enabled users with bad configurations, such as: password never expires / password not required / no pre authentication required.
tags = ["Compromised Credentials", "AD", "User Management"]
view = {
        "fields" : [
            "adapters",
            "specific_data.data.image",
            "specific_data.data.username",
            "specific_data.data.domain",
            "specific_data.data.is_admin",
            "specific_data.data.last_seen",
            "labels",
            "adapters_data.active_directory_adapter.ad_uac_password_not_required",
            "adapters_data.active_directory_adapter.ad_uac_dont_expire_password"
        ],
        "coloumnSizes" : [],
        "query" : {
            "filter" : "((adapters_data.active_directory_adapter.ad_uac_dont_expire_password == true) or (adapters_data.active_directory_adapter.ad_uac_password_not_required == true) or (adapters_data.active_directory_adapter.ad_uac_dont_require_preauth == true)) and (adapters_data.active_directory_adapter.ad_uac_account_disable == false)",
            "expressions" : [
                {
                    "logicOp" : "",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : true,
                    "field" : "adapters_data.active_directory_adapter.ad_uac_dont_expire_password",
                    "compOp" : "true",
                    "value" : null,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 0,
                    "filteredAdapters" : null,
                    "fieldType" : "active_directory_adapter"
                },
                {
                    "logicOp" : "or",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "adapters_data.active_directory_adapter.ad_uac_password_not_required",
                    "compOp" : "true",
                    "value" : null,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 1,
                    "filteredAdapters" : null,
                    "fieldType" : "active_directory_adapter"
                },
                {
                    "logicOp" : "or",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "adapters_data.active_directory_adapter.ad_uac_dont_require_preauth",
                    "compOp" : "true",
                    "value" : null,
                    "rightBracket" : true,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 2,
                    "filteredAdapters" : null,
                    "fieldType" : "active_directory_adapter"
                },
                {
                    "logicOp" : "and",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "adapters_data.active_directory_adapter.ad_uac_account_disable",
                    "compOp" : "false",
                    "value" : null,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 3,
                    "filteredAdapters" : null,
                    "fieldType" : "active_directory_adapter"
                }
            ]
        },
        "sort" : {
            "desc" : true,
            "field" : ""
        }
    }

[AD enabled users in 'Domain Admins' group]
description = AD enabled users that are members of 'Domain Admins' group.
tags = ["AD", "Privileged Users"]
view = {
        "fields" : [
            "adapters",
            "specific_data.data.image",
            "specific_data.data.username",
            "specific_data.data.domain",
            "specific_data.data.is_admin",
            "specific_data.data.last_seen",
            "labels"
        ],
        "coloumnSizes" : [],
        "query" : {
            "filter" : "(adapters_data.active_directory_adapter.ad_uac_account_disable == false) and (adapters_data.active_directory_adapter.ad_member_of == regex(\"Domain Admins\", \"i\"))",
            "expressions" : [
                {
                    "logicOp" : "",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "adapters_data.active_directory_adapter.ad_uac_account_disable",
                    "compOp" : "false",
                    "value" : null,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 0,
                    "filteredAdapters" : null,
                    "fieldType" : "active_directory_adapter"
                },
                {
                    "logicOp" : "and",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "adapters_data.active_directory_adapter.ad_member_of",
                    "compOp" : "contains",
                    "value" : "Domain Admins",
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 1,
                    "filteredAdapters" : null,
                    "fieldType" : "active_directory_adapter"
                }
            ]
        },
        "sort" : {
            "desc" : true,
            "field" : ""
        }
    }

[AD enabled users in 'Administrators' group]
description = AD enabled users that are members of the 'Administrators' group.
tags = ["AD", "Privileged Users"]
view = {
        "fields" : [
            "adapters",
            "specific_data.data.image",
            "specific_data.data.username",
            "specific_data.data.domain",
            "specific_data.data.is_admin",
            "specific_data.data.last_seen",
            "labels"
        ],
        "coloumnSizes" : [],
        "query" : {
            "filter" : "(adapters_data.active_directory_adapter.ad_uac_account_disable == false) and (adapters_data.active_directory_adapter.ad_member_of == regex(\"Administrators\", \"i\"))",
            "expressions" : [
                {
                    "logicOp" : "",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "adapters_data.active_directory_adapter.ad_uac_account_disable",
                    "compOp" : "false",
                    "value" : null,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 0,
                    "filteredAdapters" : null,
                    "fieldType" : "active_directory_adapter"
                },
                {
                    "logicOp" : "and",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "adapters_data.active_directory_adapter.ad_member_of",
                    "compOp" : "contains",
                    "value" : "Administrators",
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 1,
                    "filteredAdapters" : null,
                    "fieldType" : "active_directory_adapter"
                }
            ]
        },
        "sort" : {
            "desc" : true,
            "field" : ""
        }
    }

[AD enabled users whose password must change]
description = AD enabled users whose password must be changed.
tags = ["Old Passwords", "AD", "User Management"]
view = {
        "fields" : [
            "adapters",
            "specific_data.data.image",
            "specific_data.data.username",
            "specific_data.data.domain",
            "specific_data.data.is_admin",
            "specific_data.data.last_seen",
            "labels"
        ],
        "coloumnSizes" : [],
        "query" : {
            "filter" : "(adapters_data.active_directory_adapter.ad_uac_account_disable == false) and (adapters_data.active_directory_adapter.ad_pwd_must_change == true)",
            "expressions" : [
                {
                    "logicOp" : "",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "adapters_data.active_directory_adapter.ad_uac_account_disable",
                    "compOp" : "false",
                    "value" : null,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 0,
                    "filteredAdapters" : null,
                    "fieldType" : "active_directory_adapter"
                },
                {
                    "logicOp" : "and",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "adapters_data.active_directory_adapter.ad_pwd_must_change",
                    "compOp" : "true",
                    "value" : null,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 1,
                    "filteredAdapters" : null,
                    "fieldType" : "active_directory_adapter"
                }
            ]
        },
        "sort" : {
            "desc" : true,
            "field" : ""
        }
    }

[AD enabled locked users]
description = AD enabled locked users.
tags = ["AD", "User Management"]
view = {
        "fields" : [
            "adapters",
            "specific_data.data.image",
            "specific_data.data.username",
            "specific_data.data.domain",
            "specific_data.data.is_admin",
            "specific_data.data.last_seen",
            "labels"
        ],
        "coloumnSizes" : [],
        "query" : {
            "filter" : "(adapters_data.active_directory_adapter.ad_uac_account_disable == false) and (adapters_data.active_directory_adapter.is_locked == true)",
            "expressions" : [
                {
                    "logicOp" : "",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "adapters_data.active_directory_adapter.ad_uac_account_disable",
                    "compOp" : "false",
                    "value" : null,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 0,
                    "filteredAdapters" : null,
                    "fieldType" : "active_directory_adapter"
                },
                {
                    "logicOp" : "and",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "adapters_data.active_directory_adapter.is_locked",
                    "compOp" : "true",
                    "value" : null,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 1,
                    "filteredAdapters" : null,
                    "fieldType" : "active_directory_adapter"
                }
            ]
        },
        "sort" : {
            "desc" : true,
            "field" : ""
        }
    }

[AD disabled users]
description = AD disabled users.
tags = ["AD", "User Management"]
view = {
        "fields" : [
            "adapters",
            "specific_data.data.image",
            "specific_data.data.username",
            "specific_data.data.domain",
            "specific_data.data.is_admin",
            "specific_data.data.last_seen",
            "labels"
        ],
        "coloumnSizes" : [],
        "query" : {
            "filter" : "(adapters_data.active_directory_adapter.account_disabled == true)",
            "expressions" : [
                {
                    "logicOp" : "",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "adapters_data.active_directory_adapter.account_disabled",
                    "compOp" : "true",
                    "value" : null,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 0,
                    "filteredAdapters" : null,
                    "fieldType" : "active_directory_adapter"
                }
            ]
        },
        "sort" : {
            "desc" : true,
            "field" : ""
        }
    }

[Users with devices seen in the last 30 days]
description = Users with devices that have been seen in the last 30 days.
tags = ["General"]
view = {
        "fields" : [
            "adapters",
            "specific_data.data.image",
            "specific_data.data.username",
            "specific_data.data.domain",
            "specific_data.data.is_admin",
            "specific_data.data.last_seen",
            "labels"
        ],
        "coloumnSizes" : [],
        "query" : {
            "filter" : "(specific_data.data.last_seen_in_devices >= date(\"NOW - 30d\"))",
            "expressions" : [
                {
                    "logicOp" : "",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "specific_data.data.last_seen_in_devices",
                    "compOp" : "days",
                    "value" : 30,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 0,
                    "fieldType" : "axonius"
                }
            ]
        },
        "sort" : {
            "desc" : true,
            "field" : ""
        }
    }

[Users not from the U.S.]
description = Users with a country not listed as "US".
tags = ["General"]
view = {
        "fields" : [
            "adapters",
            "specific_data.data.image",
            "specific_data.data.username",
            "specific_data.data.domain",
            "specific_data.data.user_country",
            "specific_data.data.is_admin",
            "specific_data.data.last_seen",
            "labels"
        ],
        "coloumnSizes" : [],
        "query" : {
            "filter" : "not (specific_data.data.user_country == regex(\"US\", \"i\"))",
            "expressions" : [
                {
                    "logicOp" : "",
                    "not" : true,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "specific_data.data.user_country",
                    "compOp" : "contains",
                    "value" : "US",
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 0,
                    "fieldType" : "axonius"
                }
            ]
        },
        "sort" : {
            "desc" : true,
            "field" : ""
        }
    }

[Non-local users]
description = Users marked as not local.
tags = ["General"]
view = {
        "fields" : [
            "adapters",
            "specific_data.data.image",
            "specific_data.data.username",
            "specific_data.data.domain",
            "specific_data.data.is_admin",
            "specific_data.data.last_seen",
            "labels"
        ],
        "coloumnSizes" : [],
        "query" : {
            "filter" : "(specific_data.data.is_local == false)",
            "expressions" : [
                {
                    "logicOp" : "",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "specific_data.data.is_local",
                    "compOp" : "false",
                    "value" : null,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 0,
                    "fieldType" : "axonius"
                }
            ]
        },
        "sort" : {
            "desc" : true,
            "field" : ""
        }
    }

[Users with bad logins in the last 7 days]
description = Users with bad logins in the last 7 days.
tags = ["Logins", "User Management"]
view = {
        "fields" : [
            "adapters",
            "specific_data.data.image",
            "specific_data.data.username",
            "specific_data.data.domain",
            "specific_data.data.is_admin",
            "specific_data.data.last_seen",
            "specific_data.data.last_bad_logon",
            "labels"
        ],
        "coloumnSizes" : [],
        "query" : {
            "filter" : "(specific_data.data.last_bad_logon >= date(\"NOW - 7d\"))",
            "expressions" : [
                {
                    "logicOp" : "",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "specific_data.data.last_bad_logon",
                    "compOp" : "days",
                    "value" : 7,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 0,
                    "fieldType" : "axonius"
                }
            ]
        },
        "sort" : {
            "desc" : true,
            "field" : ""
        }
    }

[Users created in the last 30 days]
description = Users created in the last 30 days.
tags = ["Logins", "User Management"]
view = {
        "fields" : [
            "adapters",
            "specific_data.data.image",
            "specific_data.data.username",
            "specific_data.data.domain",
            "specific_data.data.is_admin",
            "specific_data.data.last_seen",
            "specific_data.data.user_created",
            "labels"
        ],
        "coloumnSizes" : [],
        "query" : {
            "filter" : "(specific_data.data.user_created >= date(\"NOW - 30d\"))",
            "expressions" : [
                {
                    "logicOp" : "",
                    "not" : false,
                    "context" : "",
                    "leftBracket" : false,
                    "field" : "specific_data.data.user_created",
                    "compOp" : "days",
                    "value" : 30,
                    "rightBracket" : false,
                    "children" : [
                        {
                            "expression" : {
                                "field" : "",
                                "compOp" : "",
                                "value" : null,
                                "filteredAdapters" : null
                            },
                            "condition" : "",
                            "i" : 0
                        }
                    ],
                    "i" : 0,
                    "fieldType" : "axonius"
                }
            ]
        },
        "sort" : {
            "desc" : true,
            "field" : ""
        }
    }