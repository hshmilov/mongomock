# ::format::
# [name]
# view = mongodb json dumps of the view

[AD Enabled Users With Bad Configurations]
view = {
        "page" : 0,
        "pageSize" : 20,
        "fields" : [
            "specific_data.data.username",
            "adapters_data.active_directory_adapter.ad_uac_dont_expire_password",
            "adapters_data.active_directory_adapter.ad_uac_password_not_required",
            "adapters_data.active_directory_adapter.ad_uac_dont_require_preauth",
            "adapters_data.active_directory_adapter.ad_uac_account_disable",
            "specific_data.data.domain",
            "specific_data.data.last_seen"
        ],
        "coloumnSizes" : [],
        "query" : {
            "filter" : "(adapters_data.active_directory_adapter.ad_uac_dont_expire_password == true or adapters_data.active_directory_adapter.ad_uac_password_not_required == true or adapters_data.active_directory_adapter.ad_uac_dont_require_preauth == true) and adapters_data.active_directory_adapter.ad_uac_account_disable == false",
            "expressions" : [
                {
                    "logicOp" : "",
                    "not" : false,
                    "leftBracket" : true,
                    "field" : "adapters_data.active_directory_adapter.ad_uac_dont_expire_password",
                    "compOp" : "true",
                    "value" : "",
                    "rightBracket" : false,
                    "i" : 0
                },
                {
                    "logicOp" : "or",
                    "not" : false,
                    "leftBracket" : false,
                    "field" : "adapters_data.active_directory_adapter.ad_uac_password_not_required",
                    "compOp" : "true",
                    "value" : "",
                    "rightBracket" : false,
                    "i" : 1
                },
                {
                    "logicOp" : "or",
                    "not" : false,
                    "leftBracket" : false,
                    "field" : "adapters_data.active_directory_adapter.ad_uac_dont_require_preauth",
                    "compOp" : "true",
                    "value" : "",
                    "rightBracket" : true,
                    "i" : 2
                },
                {
                    "logicOp" : "and",
                    "not" : false,
                    "leftBracket" : false,
                    "field" : "adapters_data.active_directory_adapter.ad_uac_account_disable",
                    "compOp" : "false",
                    "value" : "",
                    "rightBracket" : false,
                    "i" : 3
                }
            ]
        },
        "sort" : {
            "field" : "",
            "desc" : true
        }
    }

[AD Enabled Critical Users]
view = {
        "page" : 0,
        "pageSize" : 20,
        "fields" : [
            "specific_data.data.image",
            "specific_data.data.username",
            "specific_data.data.domain",
            "specific_data.data.last_seen",
            "specific_data.data.is_admin",
            "adapters_data.active_directory_adapter.ad_member_of"
        ],
        "coloumnSizes" : [],
        "query" : {
            "filter" : "adapters_data.active_directory_adapter.ad_uac_account_disable == false and (adapters_data.active_directory_adapter.ad_member_of == regex(\"Account Operators\", \"i\") or adapters_data.active_directory_adapter.ad_member_of == regex(\"Backup Operators\", \"i\") or adapters_data.active_directory_adapter.ad_member_of == regex(\"Print Operators\", \"i\") or adapters_data.active_directory_adapter.ad_member_of == regex(\"Cert Publishers\", \"i\") or adapters_data.active_directory_adapter.ad_member_of == regex(\"Server Operators\", \"i\") or adapters_data.active_directory_adapter.ad_member_of == regex(\"Schema Admins\", \"i\") or adapters_data.active_directory_adapter.ad_member_of == regex(\"Administrators\", \"i\") or adapters_data.active_directory_adapter.ad_member_of == regex(\"Domain Admins\", \"i\") or adapters_data.active_directory_adapter.ad_member_of == regex(\"Enterprise Admins\", \"i\"))",
            "expressions" : [
                {
                    "logicOp" : "",
                    "not" : false,
                    "leftBracket" : false,
                    "field" : "adapters_data.active_directory_adapter.ad_uac_account_disable",
                    "compOp" : "false",
                    "value" : "",
                    "rightBracket" : false,
                    "i" : 0
                },
                {
                    "logicOp" : "and",
                    "not" : false,
                    "leftBracket" : true,
                    "field" : "adapters_data.active_directory_adapter.ad_member_of",
                    "compOp" : "contains",
                    "value" : "Account Operators",
                    "rightBracket" : false,
                    "i" : 1
                },
                {
                    "logicOp" : "or",
                    "not" : false,
                    "leftBracket" : false,
                    "field" : "adapters_data.active_directory_adapter.ad_member_of",
                    "compOp" : "contains",
                    "value" : "Backup Operators",
                    "rightBracket" : false,
                    "i" : 2
                },
                {
                    "logicOp" : "or",
                    "not" : false,
                    "leftBracket" : false,
                    "field" : "adapters_data.active_directory_adapter.ad_member_of",
                    "compOp" : "contains",
                    "value" : "Print Operators",
                    "rightBracket" : false,
                    "i" : 3
                },
                {
                    "logicOp" : "or",
                    "not" : false,
                    "leftBracket" : false,
                    "field" : "adapters_data.active_directory_adapter.ad_member_of",
                    "compOp" : "contains",
                    "value" : "Cert Publishers",
                    "rightBracket" : false,
                    "i" : 4
                },
                {
                    "logicOp" : "or",
                    "not" : false,
                    "leftBracket" : false,
                    "field" : "adapters_data.active_directory_adapter.ad_member_of",
                    "compOp" : "contains",
                    "value" : "Server Operators",
                    "rightBracket" : false,
                    "i" : 5
                },
                {
                    "logicOp" : "or",
                    "not" : false,
                    "leftBracket" : false,
                    "field" : "adapters_data.active_directory_adapter.ad_member_of",
                    "compOp" : "contains",
                    "value" : "Schema Admins",
                    "rightBracket" : false,
                    "i" : 6
                },
                {
                    "logicOp" : "or",
                    "not" : false,
                    "leftBracket" : false,
                    "field" : "adapters_data.active_directory_adapter.ad_member_of",
                    "compOp" : "contains",
                    "value" : "Administrators",
                    "rightBracket" : false,
                    "i" : 7
                },
                {
                    "logicOp" : "or",
                    "not" : false,
                    "leftBracket" : false,
                    "field" : "adapters_data.active_directory_adapter.ad_member_of",
                    "compOp" : "contains",
                    "value" : "Domain Admins",
                    "rightBracket" : false,
                    "i" : 8
                },
                {
                    "logicOp" : "or",
                    "not" : false,
                    "leftBracket" : false,
                    "field" : "adapters_data.active_directory_adapter.ad_member_of",
                    "compOp" : "contains",
                    "value" : "Enterprise Admins",
                    "rightBracket" : true,
                    "i" : 9
                }
            ]
        },
        "sort" : {
            "field" : "",
            "desc" : true
        }
    }